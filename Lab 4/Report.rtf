{\rtf1\ansi\ansicpg1252\deff0\nouicompat\deflang1033{\fonttbl{\f0\fnil\fcharset0 Consolas;}{\f1\fnil Consolas;}{\f2\fnil\fcharset0 Calibri;}}
{\colortbl ;\red255\green255\blue255;\red0\green0\blue255;\red0\green0\blue0;\red128\green128\blue128;\red255\green0\blue0;\red255\green0\blue255;}
{\*\generator Riched20 10.0.15063}\viewkind4\uc1 
\pard\sl240\slmult1\highlight1\f0\fs20 The following code inserts Joyce English's new husband into the dependent table, no birthday was specified so a null character was inserted until the information can be obtained. Employee Jennifer Wallace's new daughter was entered into the dependent table. Her daughter's birthday was set to 3-26-2018 because I assumed she was born on the day that the value was entered into the table. Finally, Jennifer Wallace is added to project 10 in the Works_On table.\cf2\f1\fs19\lang9\par
\i use\cf3  company\par
\cf2 go\cf3\par
\cf2 insert\cf3  \cf2 into\cf3  \cf2 Dependent\cf3  \cf2 Values\cf4 (\cf5 '453453453'\cf4 ,\cf5 'Joe'\cf4 ,\cf3  \cf5 'M'\cf4 ,NULL,\cf3  \cf5 'Spouse'\cf4 );\cf3\par
\cf2 insert\cf3  \cf2 into\cf3  \cf2 Dependent\cf3  \cf2 Values\cf4 (\cf5 '987654321'\cf4 ,\cf3  \cf5 'Erica'\cf4 ,\cf3  \cf5 'F'\cf4 ,\cf3  \cf5 '03-26-2018'\cf4 ,\cf3  \cf5 'Daughter'\cf4 );\cf3\par
\cf2 insert\cf3  \cf2 into\cf3  WORKS_ON \cf2 values\cf4 (\cf5 '987654321'\cf4 ,\cf3  10\cf4 ,\cf3  0\cf4 );\par
\par
\cf0\i0\f0\fs20\lang1033 The following code selects the dependent and Works_On tables to show the entered values from above.\par
\cf2\i\f1\fs19 use\cf3  Company\par
\par
\cf2 Select\cf3  \cf4 *\cf3\par
\cf2 from\cf3  \cf2 Dependent\cf4 ;\cf3\par
\par
\cf2 select\cf3  \cf4 *\cf3\par
\cf2 From\cf3  Works_ON\cf4 ;\cf3\par
\cf0\f0\fs20\par
\cf4\f1\fs19\lang9\par
\cf3\par
\i0\f0\lang1033 Q1: The following selection lists all departments with the first and last name of the employees working in the department and the first and last name of their immediate supervisor. Includes employees that do not have an immediate supervisor and includes departments that do not have any employees assigned to them.\par
\i\f1\lang9\par
\cf2 use\cf3  company\par
\cf2 go\cf3\par
\par
\par
\cf2 SELECT\cf3  D\cf4 .\cf3 Dnumber\cf4 ,\cf3  A\cf4 .\cf3 fname\cf4 ,\cf3  A\cf4 .\cf3 Lname\cf4 ,\cf3  b\cf4 .\cf3 fname\cf4 ,\cf3  b\cf4 .\cf3 lname\par
\tab\cf2 from\cf3  Department d\par
\tab\cf2 FULL\cf3  \cf4 JOIN\cf3  Employee a \cf2 ON\cf3  A\cf4 .\cf3 DNO\cf4 =\cf3 d\cf4 .\cf3 Dnumber\par
\tab\cf2 FULL\cf3  \cf4 JOIN\cf3  EMPLOYEE b \cf2 ON\cf3  b\cf4 .\cf3 ssn\cf4 =\cf3 a\cf4 .\cf3 SuperSSN\par
\tab\cf2 WHERE\cf3  d\cf4 .\cf3 DNUMBER \cf4 IS\cf3  \cf4 NOT\cf3  \cf4 NULL\cf3\par
\tab\cf2 Group\cf3  \cf2 by\cf3  D\cf4 .\cf3 Dnumber\cf4 ,\cf3  A\cf4 .\cf3 fname\cf4 ,\cf3  A\cf4 .\cf3 Lname\cf4 ,\cf3  b\cf4 .\cf3 fname\cf4 ,\cf3  b\cf4 .\cf3 lname\par
\i0\tab\par
\i\par
\cf0\i0\f0\fs20\lang1033 Q1_1: The following code lists all the employees who are working in a department by listing their first and last name as well as the first and last name of their immediate supervisor. The selection includes employees with no immediate supervisor. Additionally, departments that no employees are assigned to are suppressed.\cf3\i\f1\fs19\lang9\par
\cf2 use\cf3  company\par
\cf2 go\cf3\par
\cf2 use\cf3  company\par
\cf2 go\cf3\par
\par
\par
\cf2 SELECT\cf3  D\cf4 .\cf3 Dnumber\cf4 ,\cf3  E\cf4 .\cf3 FNAME\cf4 ,\cf3  E\cf4 .\cf3 LNAME\cf4 ,\cf3  S\cf4 .\cf3 FNAME\cf4 ,\cf3  S\cf4 .\cf3 LNAME\par
 \cf2 FROM\cf3   EMPLOYEE E  \cf4 LEFT\cf3  \cf4 OUTER\cf3  \cf4 JOIN\cf3  EMPLOYEE S \cf2 ON\cf3  E\cf4 .\cf3 SuperSsn \cf4 =\cf3  S\cf4 .\cf3 SSN\cf4 ,\cf3  DEPARTMENT D \par
 \cf2 WHERE\cf3  D\cf4 .\cf3 Dnumber \cf4 =\cf3  E\cf4 .\cf3 Dno  \par
\cf2 ORDER\cf3  \cf2 BY\cf3  D\cf4 .\cf3 Dnumber\cf4 ,\cf3  E\cf4 .\cf3 Fname\cf4 ;\cf3  \par
\i0\f0\lang1033\par
Q2:The following selection gets the SSN and last name of any married female employees that are currently working on three or more projects.\par
\cf2\i\f1 use\cf3  company\par
\cf2 go\cf3\par
\par
\cf2 select\cf3  e\cf4 .\cf3 SSN\cf4 ,\cf3  e\cf4 .\cf3 Lname\par
\cf2 from\cf3  employee e\cf4 ,\cf3  WORKS_ON w\par
\cf2 where\cf3  e\cf4 .\cf3 SSN\cf4 =\cf3 w\cf4 .\cf3 Essn \cf4 AND\cf3  e\cf4 .\cf3 Sex\cf4 =\cf5 'F'\cf3\par
\cf2 Group\cf3  \cf2 by\cf3  e\cf4 .\cf3 SSN\cf4 ,\cf3  e\cf4 .\cf3 Lname\par
\cf2 Having\cf3  \cf6 Count\cf4 (\cf3 w\cf4 .\cf3 Essn\cf4 )>\cf3 2\cf4 ;\cf3\f0\par
\i0\par
Q3:The following selection statement retrieves the first and last names of all employees that work for the "Research" department, are married, and have no children.\par
\f1\lang9\par
\cf2\i use\cf3  company\par
\cf2 go\cf3\par
\par
\par
\cf2 select\cf3  \cf2 Distinct\cf3  e\cf4 .\cf3 fname\cf4 ,\cf3  e\cf4 .\cf3 lname\par
\cf2 from\cf3  employee e\par
\tab\cf4 Inner\cf3  \cf4 Join\cf3  department d \cf2 ON\cf3  e\cf4 .\cf3 DNO\cf4 =\cf3 d\cf4 .\cf3 Dnumber\par
\tab\cf4 Inner\cf3  \cf4 Join\cf3  \cf2 Dependent\cf3  p \cf2 ON\cf3  e\cf4 .\cf3 SSN\cf4 =\cf3 p\cf4 .\cf3 parentSSN\par
\cf2 where\cf3  p\cf4 .\cf3 relationship\cf4 !=\cf5 'Son'\cf3  \cf4 or\cf3  p\cf4 .\cf3 relationship\cf4 !=\cf5 'Daughter'\cf3  \cf4 and\cf3  d\cf4 .\cf3 Dname\cf4 =\cf5 'Research'\cf3  \cf4 and\cf3  p\cf4 .\cf3 relationship\cf4 =\cf5 'Spouse'\cf3\par
\cf2 GROUP\cf3  \cf2 BY\cf3  E\cf4 .\cf3 FNAME\cf4 ,\cf3  E\cf4 .\cf3 LNAME\par
\cf2 having\cf3  \cf6 COUNT\cf4 (\cf3 p\cf4 .\cf3 parentSSN\cf4 )<\cf3 2\par
\i0\par
\f0\lang1033 Q4:The following selection retieves all employees who are married and only have a daughter.\par
\f1\lang9\par
\cf2\i use\cf3  company\par
\cf2 go\cf3\par
\par
\par
\cf2 select\cf3  e\cf4 .\cf3 fname\cf4 ,\cf3  e\cf4 .\cf3 lname\par
\cf2 from\cf3  employee e\par
\cf4 RIGHT\cf3  \cf4 JOIN\cf3  \cf2 DEPENDENT\cf3  d \cf2 ON\cf3  d\cf4 .\cf3 relationship\cf4 =\cf5 'Spouse'\cf3\par
\cf4 RIGHT\cf3  \cf4 JOIN\cf3  \cf2 DEPENDENT\cf3  o \cf2 ON\cf3  o\cf4 .\cf3 relationship\cf4 =\cf5 'Daughter'\cf3\par
\cf2 where\cf3  e\cf4 .\cf3 SSN\cf4 =\cf3 d\cf4 .\cf3 parentSSN \cf4 and\cf3  e\cf4 .\cf3 SSN\cf4 =\cf3 o\cf4 .\cf3 parentSSN \cf4 and\cf3  d\cf4 .\cf3 parentSSN \cf4 NOT\cf3  \cf4 IN\cf2  \cf4 (\cf2 Select\cf3  d2\cf4 .\cf3 parentSSN\par
\tab\cf2 From\cf3  \cf2 Dependent\cf3  d2\par
\tab\cf2 WHERE\cf3  d\cf4 .\cf3 parentSSN\cf4 =\cf3 d2\cf4 .\cf3 parentSSN \cf4 and\cf3  d2\cf4 .\cf3 relationship\cf4 =\cf5 'Son'\cf4 )\cf3\par
\cf2 Group\cf3  \cf2 BY\cf3  e\cf4 .\cf3 fname\cf4 ,\cf3  e\cf4 .\cf3 lname\cf4 ;\cf3\par
\i0\par
\f0\lang1033 Q5: The following slect statements list the last name and social security number of all the employees that work on a project where there are more female employees than male. The command uses 2 nested subqueires to count the number of male employees on each project and the number of females employees on each prject. The counts are stored as a seperate tables called men and fem containing project number and the count of male and female workers. The outter selection uses the subquiries table to identify the projects with more females than males and then retrieves the last name and SSN of all the employees that work on the project.\par
\f1\par
\cf2\i use\cf3  company\par
\cf2 go\cf3\par
\par
\par
\cf2 Select\cf3  \cf2 Distinct\cf3  e\cf4 .\cf3 lname\cf4 ,\cf3  e\cf4 .\cf3 ssn \par
\cf2 From\cf3  Works_on w\cf4 ,\cf3  employee e\cf4 ,\cf3\par
\cf4 (\cf2 Select\cf3  w2\cf4 .\cf3 pno\cf4 ,\cf3  \cf6 Count\cf4 (\cf3 w2\cf4 .\cf3 essn\cf4 )\cf3\par
\cf2 From\cf3  Works_on w2\cf4 ,\cf3  Employee e2\par
\cf2 Where\cf3  w2\cf4 .\cf3 essn \cf4 =\cf3  e2\cf4 .\cf3 ssn \cf4 and\cf3  e2\cf4 .\cf3 sex \cf4 =\cf3  \cf5 'M'\cf3\par
\cf2 Group\cf3  \cf2 By\cf3  w2\cf4 .\cf3 pno\cf4 )\cf3  \cf2 As\cf3  men\cf4 (\cf3 pno\cf4 ,\cf3  Mcnt\cf4 ),\cf3\par
\par
\cf4 (\cf2 Select\cf3  w1\cf4 .\cf3 pno\cf4 ,\cf3  \cf6 Count\cf4 (\cf3 w1\cf4 .\cf3 essn\cf4 )\cf3\par
\cf2 From\cf3  Works_on w1\cf4 ,\cf3  Employee e1\par
\cf2 Where\cf3  w1\cf4 .\cf3 essn \cf4 =\cf3  e1\cf4 .\cf3 ssn \cf4 AND\cf3  e1\cf4 .\cf3 sex \cf4 =\cf3  \cf5 'F'\cf3\par
\cf2 Group\cf3  \cf2 By\cf3  w1\cf4 .\cf3 pno\cf4 )\cf3  \cf2 As\cf3  fem\cf4 (\cf3 pno\cf4 ,\cf3  Fcnt\cf4 )\cf3\par
\cf2 where\cf3  e\cf4 .\cf3 ssn \cf4 =\cf3  w\cf4 .\cf3 essn\par
\cf4 AND\cf3  w\cf4 .\cf3 Pno\cf4 =\cf3 fem\cf4 .\cf3 pno\par
\cf4 AND\cf3  men\cf4 .\cf3 pno \cf4 =\cf3  fem\cf4 .\cf3 pno\par
\cf4 AND\cf3  fem\cf4 .\cf3 Fcnt \cf4 >\cf3  men\cf4 .\cf3 Mcnt\par
\cf2 Order\cf3  \cf2 By\cf3  e\cf4 .\cf3 lname\cf4 ,\cf3  e\cf4 .\cf3 SSN\par
\lang9\par
\cf0\highlight0\i0\f2\fs22\par
}
 